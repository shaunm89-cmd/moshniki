<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mila's Pop Party</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@700&display=swap');

        body {
            margin: 0;
            overflow: hidden; /* Stop scrolling */
            background: linear-gradient(to bottom, #87CEEB, #E0F7FA);
            font-family: 'Fredoka', sans-serif;
            touch-action: none; /* Crucial for fast tapping */
            height: 100vh;
            width: 100vw;
        }

        /* The Scoreboard */
        #ui-layer {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            pointer-events: none; /* Let clicks pass through */
            z-index: 10;
        }

        #score {
            font-size: 4rem;
            color: #fff;
            text-shadow: 4px 4px 0px rgba(0,0,0,0.2);
            margin: 0;
        }

        #label {
            font-size: 1.5rem;
            color: #0277BD;
            margin-top: -10px;
        }

        /* The Bubbles */
        .bubble {
            position: absolute;
            bottom: -100px; /* Start below screen */
            width: 90px;
            height: 90px;
            background-color: rgba(255, 255, 255, 0.6);
            border: 3px solid rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3.5rem;
            cursor: pointer;
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.5);
            animation: floatUp linear forwards;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Different speeds for bubbles */
        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-120vh) rotate(20deg); }
        }

        /* The Start Screen */
        #start-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255,255,255,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        h1 {
            color: #FF6F00;
            font-size: 3rem;
            text-shadow: 2px 2px #FFD54F;
            margin-bottom: 20px;
            text-align: center;
        }

        button {
            background-color: #7E57C2;
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 2rem;
            border-radius: 50px;
            font-family: 'Fredoka', sans-serif;
            box-shadow: 0 8px #512DA8;
            cursor: pointer;
        }

        button:active {
            transform: translateY(5px);
            box-shadow: 0 0 #512DA8;
        }

        /* Pop animation class */
        .popped {
            transition: transform 0.1s;
            transform: scale(1.5);
            opacity: 0;
        }
    </style>
</head>
<body>

    <div id="ui-layer">
        <div id="score">0</div>
        <div id="label">Mila's Points</div>
    </div>

    <div id="game-area"></div>

    <div id="start-screen">
        <h1>Mila's<br>Pop Party! üéà</h1>
        <button onclick="startGame()">PLAY ‚ñ∂Ô∏è</button>
    </div>

<script>
    // --- SETTINGS ---
    let score = 0;
    let gameActive = false;
    let spawnRate = 1000; // New bubble every 1 second (decreases over time)

    // EMOJI DATABASE (Labubu stand-ins + Toy Story)
    const characters = [
        "ü§†", // Woody
        "üöÄ", // Buzz
        "üëΩ", // Alien
        "ü¶ñ", // Rex
        "üê∞", // Labubu (Bunny ears)
        "üëπ", // Monster
        "üíÄ", // Tycoco
        "üëª", // Spooky
        "üê∑", // Hamm
        "‚≠ê", // Star
        "üíñ"  // Heart
    ];

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        score = 0;
        document.getElementById('score').innerText = score;
        gameActive = true;
        gameLoop();
    }

    function gameLoop() {
        if (!gameActive) return;

        spawnBubble();

        // Randomize spawn time between 600ms and 1400ms
        let nextSpawn = Math.random() * 800 + 600;
        setTimeout(gameLoop, nextSpawn);
    }

    function spawnBubble() {
        const gameArea = document.getElementById('game-area');
        const bubble = document.createElement('div');
        
        // Pick random character
        const char = characters[Math.floor(Math.random() * characters.length)];
        bubble.innerText = char;
        bubble.classList.add('bubble');

        // Random Position (Left to Right)
        // We subtract 90px (width of bubble) to keep it on screen
        const randomLeft = Math.random() * (window.innerWidth - 100);
        bubble.style.left = randomLeft + 'px';

        // Random Speed (3s to 6s)
        const duration = Math.random() * 3 + 3;
        bubble.style.animationDuration = duration + 's';

        // CLICK EVENT
        bubble.onpointerdown = function(e) {
            popBubble(bubble, e);
        };

        // Remove bubble when animation ends (it floats off screen)
        bubble.addEventListener('animationend', () => {
            bubble.remove();
        });

        gameArea.appendChild(bubble);
    }

    function popBubble(element, event) {
        if (element.classList.contains('popped')) return; // Prevent double taps
        element.classList.add('popped');
        
        // Play Pop Sound (Synthesized so no audio files needed!)
        playPopSound();

        // Increment Score
        score++;
        document.getElementById('score').innerText = score;

        // Visual Explosion (Confetti)
        // We calculate where the click happened to center the confetti
        const x = event.clientX / window.innerWidth;
        const y = event.clientY / window.innerHeight;

        confetti({
            particleCount: 15,
            spread: 60,
            origin: { x: x, y: y },
            colors: ['#FFD54F', '#81D4FA', '#FF8A65', '#9575CD'],
            disableForReducedMotion: true,
            zIndex: 100
        });

        // Remove element quickly after visual pop
        setTimeout(() => element.remove(), 100);
    }

    // Audio Context for Beeps/Boops (No external files needed)
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioContext();

    function playPopSound() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();

        oscillator.type = 'sine';
        // Random pitch for fun
        oscillator.frequency.setValueAtTime(400 + Math.random() * 200, audioCtx.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.1);

        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);

        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        oscillator.start();
        oscillator.stop(audioCtx.currentTime + 0.1);
    }

</script>
</body>
</html>
