<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Striker League</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #050505;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Arial Black', sans-serif;
        }
        canvas {
            box-shadow: 0 0 50px rgba(0, 255, 100, 0.1);
            border: 5px solid #222;
        }
        #ui {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            pointer-events: none;
            z-index: 10;
        }
        .score { font-size: 4rem; margin: 0 20px; text-shadow: 0 0 20px currentColor; }
        #p-score { color: #00ffff; }
        #ai-score { color: #ff0055; }
        #message {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 3rem;
            text-shadow: 0 0 20px white;
            display: none;
            text-align: center;
        }
        #stamina-container {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 200px;
            height: 10px;
            background: #333;
            transform: skewX(-20deg);
            border: 2px solid #555;
        }
        #stamina-bar {
            height: 100%;
            width: 100%;
            background: #00ffff;
            box-shadow: 0 0 10px #00ffff;
        }
    </style>
</head>
<body>

    <div id="ui">
        <span id="p-score" class="score">0</span>
        <span style="color:white; font-size: 2rem;">-</span>
        <span id="ai-score" class="score">0</span>
    </div>

    <div id="stamina-container"><div id="stamina-bar"></div></div>
    <div id="message">GOAL!</div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const pScoreEl = document.getElementById('p-score');
    const aiScoreEl = document.getElementById('ai-score');
    const msgEl = document.getElementById('message');
    const staminaBar = document.getElementById('stamina-bar');

    // Setup Dimensions (Landscape Pitch)
    canvas.width = Math.min(window.innerWidth - 40, 1000);
    canvas.height = Math.min(window.innerHeight - 40, 600);

    // Audio Context
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // Game State
    let playerScore = 0;
    let aiScore = 0;
    let gameActive = true;
    let slowMoTimer = 0;
    let particles = [];

    // Inputs
    const keys = { w: false, a: false, s: false, d: false, space: false };
    window.addEventListener('keydown', e => {
        if(e.key === 'w' || e.key === 'ArrowUp') keys.w = true;
        if(e.key === 'a' || e.key === 'ArrowLeft') keys.a = true;
        if(e.key === 's' || e.key === 'ArrowDown') keys.s = true;
        if(e.key === 'd' || e.key === 'ArrowRight') keys.d = true;
        if(e.key === ' ') keys.space = true;
    });
    window.addEventListener('keyup', e => {
        if(e.key === 'w' || e.key === 'ArrowUp') keys.w = false;
        if(e.key === 'a' || e.key === 'ArrowLeft') keys.a = false;
        if(e.key === 's' || e.key === 'ArrowDown') keys.s = false;
        if(e.key === 'd' || e.key === 'ArrowRight') keys.d = false;
        if(e.key === ' ') keys.space = false;
    });

    // Sound Synth
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if (type === 'kick') {
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.exponentialRampToValueAtTime(0.01, now + 0.1);
            gain.gain.setValueAtTime(0.5, now);
            gain.gain.linearRampToValueAtTime(0, now + 0.1);
            osc.start(now); osc.stop(now + 0.1);
        } else if (type === 'goal') {
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(200, now);
            osc.frequency.linearRampToValueAtTime(600, now + 0.5);
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.linearRampToValueAtTime(0, now + 2);
            osc.start(now); osc.stop(now + 2);
        }
    }

    // --- ENTITIES ---

    class Entity {
        constructor(x, y, radius, color, mass) {
            this.x = x; this.y = y; this.radius = radius;
            this.color = color; this.mass = mass;
            this.dx = 0; this.dy = 0;
            this.friction = 0.96;
            this.speed = 0.5;
            this.maxSpeed = 6;
        }

        update() {
            this.x += this.dx;
            this.y += this.dy;
            
            // Friction
            this.dx *= this.friction;
            this.dy *= this.friction;

            // Wall Collisions
            if (this.x - this.radius < 0) { this.x = this.radius; this.dx *= -0.8; }
            if (this.x + this.radius > canvas.width) { this.x = canvas.width - this.radius; this.dx *= -0.8; }
            if (this.y - this.radius < 0) { this.y = this.radius; this.dy *= -0.8; }
            if (this.y + this.radius > canvas.height) { this.y = canvas.height - this.radius; this.dy *= -0.8; }
        }

        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.shadowBlur = 15;
            ctx.shadowColor = this.color;
            ctx.fill();
            ctx.shadowBlur = 0;
            ctx.strokeStyle = "#fff";
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.closePath();
        }
    }

    // Player & AI extend Entity
    class Player extends Entity {
        constructor(x, y, color) {
            super(x, y, 25, color, 10);
            this.stamina = 100;
        }
        
        control() {
            let speed = this.speed;
            
            // Turbo
            if (keys.space && this.stamina > 0) {
                speed *= 2.5;
                this.stamina -= 2;
            } else if (this.stamina < 100) {
                this.stamina += 0.5;
            }
            staminaBar.style.width = this.stamina + "%";

            if (keys.w) this.dy -= speed;
            if (keys.s) this.dy += speed;
            if (keys.a) this.dx -= speed;
            if (keys.d) this.dx += speed;
        }

        aiControl(ball) {
            // Simple AI logic
            let targetX = ball.x;
            let targetY = ball.y;

            // If ball is behind AI, rush back to goal
            if (ball.x > this.x) {
                targetX = canvas.width - 50; 
                targetY = canvas.height / 2;
            }

            const angle = Math.atan2(targetY - this.y, targetX - this.x);
            this.dx += Math.cos(angle) * (this.speed * 0.8);
            this.dy += Math.sin(angle) * (this.speed * 0.8);
        }
    }

    // Initialize
    const player = new Player(100, canvas.height/2, '#00ffff');
    const ai = new Player(canvas.width - 100, canvas.height/2, '#ff0055');
    const ball = new Entity(canvas.width/2, canvas.height/2, 12, '#ffffff', 1);
    ball.friction = 0.985; // Ball rolls longer

    // --- PHYSICS ---

    function resolveCollision(p1, p2) {
        const dx = p2.x - p1.x;
        const dy = p2.y - p1.y;
        const dist = Math.hypot(dx, dy);

        if (dist < p1.radius + p2.radius) {
            playSound('kick');

            // Normalize
            const nx = dx / dist;
            const ny = dy / dist;

            // Minimum translation to unstuck
            const overlap = (p1.radius + p2.radius - dist) / 2;
            p1.x -= nx * overlap; p1.y -= ny * overlap;
            p2.x += nx * overlap; p2.y += ny * overlap;

            // Velocity swap based on mass
            // Simple elastic collision approx for game feel
            const speed1 = Math.sqrt(p1.dx*p1.dx + p1.dy*p1.dy);
            const speed2 = Math.sqrt(p2.dx*p2.dx + p2.dy*p2.dy);

            // Add "Kick" force
            const force = 1.5; 
            
            p2.dx += nx * force * 5; 
            p2.dy += ny * force * 5;
            p1.dx -= nx * force;
            p1.dy -= ny * force;
        }
    }

    // --- GAME LOOP ---

    function drawPitch() {
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 4;
        
        // Center Line
        ctx.beginPath();
        ctx.moveTo(canvas.width/2, 0);
        ctx.lineTo(canvas.width/2, canvas.height);
        ctx.stroke();

        // Center Circle
        ctx.beginPath();
        ctx.arc(canvas.width/2, canvas.height/2, 70, 0, Math.PI*2);
        ctx.stroke();

        // Goals
        ctx.shadowBlur = 20;
        // Left Goal (Player)
        ctx.shadowColor = '#00ffff';
        ctx.strokeRect(0, canvas.height/2 - 70, 40, 140);
        // Right Goal (AI)
        ctx.shadowColor = '#ff0055';
        ctx.strokeRect(canvas.width - 40, canvas.height/2 - 70, 40, 140);
        ctx.shadowBlur = 0;
    }

    function resetPositions() {
        ball.x = canvas.width/2; ball.y = canvas.height/2;
        ball.dx = 0; ball.dy = 0;
        player.x = 100; player.y = canvas.height/2; player.dx=0; player.dy=0;
        ai.x = canvas.width - 100; ai.y = canvas.height/2; ai.dx=0; ai.dy=0;
    }

    function checkGoal() {
        const goalTop = canvas.height/2 - 70;
        const goalBottom = canvas.height/2 + 70;

        // Player Scored (Right side)
        if (ball.x > canvas.width - 20 && ball.y > goalTop && ball.y < goalBottom) {
            playerScore++;
            goalEffect("GOAL!", '#00ffff');
        }
        // AI Scored (Left side)
        else if (ball.x < 20 && ball.y > goalTop && ball.y < goalBottom) {
            aiScore++;
            goalEffect("ENEMY SCORED", '#ff0055');
        }
    }

    function goalEffect(text, color) {
        pScoreEl.innerText = playerScore;
        aiScoreEl.innerText = aiScore;
        
        msgEl.innerText = text;
        msgEl.style.color = color;
        msgEl.style.textShadow = `0 0 30px ${color}`;
        msgEl.style.display = 'block';
        
        playSound('goal');
        slowMoTimer = 60; // 1 second of slow mo
        
        // Explosion
        for(let i=0; i<50; i++) {
            particles.push({
                x: ball.x, y: ball.y,
                dx: (Math.random()-0.5)*10, dy: (Math.random()-0.5)*10,
                color: color, life: 1.0
            });
        }

        setTimeout(() => {
            msgEl.style.display = 'none';
            resetPositions();
        }, 1500);
    }

    function update() {
        if (!gameActive) return;
        requestAnimationFrame(update);

        // SLOW MOTION LOGIC
        if (slowMoTimer > 0) {
            slowMoTimer--;
            // Skip every other frame to simulate slow motion
            if (slowMoTimer % 2 !== 0) return; 
        }

        ctx.fillStyle = 'rgba(5, 5, 5, 0.4)'; // Trails
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        drawPitch();

        // Update Physics
        player.control();
        player.update();
        
        ai.aiControl(ball);
        ai.update();
        
        ball.update();

        // Collisions
        resolveCollision(player, ball);
        resolveCollision(ai, ball);
        resolveCollision(player, ai); // Players can bump each other

        // Draw Entities
        player.draw();
        ai.draw();
        ball.draw();

        // Particles
        particles.forEach((p, i) => {
            p.x += p.dx; p.y += p.dy;
            p.life -= 0.02;
            ctx.fillStyle = p.color;
            ctx.globalAlpha = p.life;
            ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI*2); ctx.fill();
            ctx.globalAlpha = 1.0;
            if(p.life <= 0) particles.splice(i, 1);
        });

        // Check Goal
        if (slowMoTimer === 0) checkGoal();

        // End Game Check
        if (playerScore >= 5 || aiScore >= 5) {
            gameActive = false;
            msgEl.innerText = playerScore >= 5 ? "YOU WIN! üèÜ" : "GAME OVER üíÄ";
            msgEl.style.display = 'block';
        }
    }

    resetPositions();
    update();

</script>
</body>
</html>
