<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moshniki's ECDD Report Tool</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .report-card { border-left: 5px solid #0d6efd; margin-bottom: 20px; }
        .source-tag { font-size: 0.8rem; text-transform: uppercase; font-weight: bold; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="text-center no-print mb-5">
            <h1>üõ°Ô∏è ECDD Intelligence Portal</h1>
            <p class="text-muted">Generate comprehensive due diligence reports on individuals and entities.</p>
            <form action="/generate-report" method="POST" class="row g-3 justify-content-center">
                <div class="col-md-6">
                    <input type="text" name="target_name" class="form-control form-control-lg" placeholder="Enter Full Name or Business Name" required>
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary btn-lg">Run Deep Search</button>
                </div>
            </form>
        </div>

        {% if report %}
        <div id="report-section">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Intelligence Report: {{ report.name }}</h2>
                <button onclick="window.print()" class="btn btn-outline-secondary no-print">üñ®Ô∏è Print PDF</button>
            </div>

            <div class="card report-card shadow-sm">
                <div class="card-body">
                    <span class="source-tag text-primary">Australian Business Register (ABN)</span>
                    <h5 class="mt-2">Business Affiliations</h5>
                    <ul class="list-group list-group-flush">
                        {% for biz in report.business_data %}
                        <li class="list-group-item">{{ biz.Name }} - <strong>{{ biz.Abn }}</strong> ({{ biz.State }})</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <div class="card report-card shadow-sm" style="border-left-color: #198754;">
                <div class="card-body">
                    <span class="source-tag text-success">Digital Footprint (Social & Web)</span>
                    <h5 class="mt-2">Social Profiles & Mentions</h5>
                    <div class="row">
                        {% for link in report.social_data %}
                        <div class="col-md-6 mb-2">
                            <a href="{{ link.url }}" target="_blank" class="text-decoration-none">üîó {{ link.title }}</a>
                            <br><small class="text-muted">{{ link.snippet }}</small>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="card report-card shadow-sm" style="border-left-color: #dc3545;">
                <div class="card-body">
                    <span class="source-tag text-danger">Public Records & Property</span>
                    <p class="text-muted italic">Automated cross-referencing public domain registers...</p>
                    <p>Total Matches Found: {{ report.property_count }}</p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>
